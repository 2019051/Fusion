{% load humanize %}

<button class="ui secondary button details building_{{ forloop.counter0 }}">Details</button>
<div class="ui modal details building_{{ forloop.counter0 }}">
    <i class="close icon"></i>
    <div class="header">
        {{ building.name }}
    </div>
    <div class="content">
        <div class="description">
            <table class="ui celled definition table">
                <tbody>
                    <tr>
                        <td>Date of Approval</td>
                        <td id="building_date_approval">{{ building.date_approval }}</td>
                    </tr>
                    <tr>
                        <td>Date of Start</td>
                        <td id="building_date_start">{{ building.date_start }}</td>
                    </tr>
                    <tr>
                        <td>Amount</td>
                        <td id="building_amount">₹&nbsp;{{ building.amount|intcomma }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<script>
    $('.building_{{ forloop.counter0 }}.details.modal')
        .modal('attach events', '.building_{{ forloop.counter0 }}.details.button',
            'show');
</script>

{% comment %}

<div class="ui modal details">
    {% include 'estate/building_detail.html' %}
</div>

{{ buildings|json_script:"buildings-data" }}

<script>
    $('.details.button').on('click', function (e) {
        //const id = Number($(this).attr("data-id"));
        const id = e.target.attributes["data-id"].nodeValue;
        const building = JSON.parse(document.getElementById('buildings-data').textContent)[id];

        $('.details.modal')
            .modal({
                onShow: function () {
                    $('.details.modal .header')
                        .text(building.name);
                    $('.details.modal tbody td#building_date_approval')
                        .text(building.date_approval);
                    $('.details.modal tbody td#building_date_start')
                        .text(building.date_start);
                    $('.details.modal tbody td#building_amount')
                        .text("₹ " + building.amount)
                }
            })
            .modal('show');
    });
</script>

{% endcomment %}